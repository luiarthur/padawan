---
title: "Expectation Propagation"
date: 2016-02-17
comments: cucumber
---

Estimated posterior
$$
  \hat{p}(u) = \frac{q^{-i}(u) t_i(u)}{q^{-i}(u) t_i(u)} 
$$

## Example

$$ p(y | u) = (1-w) N(y|u,I) + w~ N(y|0,10I) $$

where w is known.

$ p(u) = N(u \| 0,100 I)$. $$D = \brac{y_1,...,y_n}$$

Goal: Find posterior $p(u \| y\_1,...,y\_n$. We want to find an approximating posterior using ADF.

$$
  \brac{q:q(u) = N(u|m_u,v_uI)}
$$

So the posterior and prior have the same form.

$$
  \begin{aligned}
    q^{-i} &= N(u|m_u^{-i},v_u^{-i}I_d) \\
    \\
    z_i &= \int~p(y_i|u)q{-i}(u)~du \\
    &=(1-w)N(y_i | m^{-i}\_u, (v_u^{-i})I) + w N(y_i|0,10I)\\
    \\
    \hat{p}(u) &= \frac{p(y_i|u)q^{-i}(u)}{\int~p(y_i|u)q^{-i}(u)~du} \\
    &= \frac{p(y_i|u)q^{-i}(u)}{z_i}
  \end{aligned}
$$

choose $q$ that minimizes KL with $\hat{p}$
