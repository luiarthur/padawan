<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>D3 Demo: Making a bar chart with value labels!</title>
		<script type="text/javascript" src="/js/d3.min.js"></script>
		<style type="text/css">
			/* No style rules here yet */		
		</style>
	</head>
	<body>
		<script type="text/javascript">
      function barchart(data,scaling,w,h,barPadding) {
        //Width and height
        if (w === undefined) {
          var w = 500;
        }
        if (h === undefined) {
          var h = 100;
        }
        if (barPadding === undefined) {
          var barPadding = 1;
        }
        if (scaling === undefined) {
          var scaling = 1;
        }

        vals = [];
        for (i=0;  i < data.length; i++) {
          vals.push(data[i].val);
        }

        //Create SVG element
        yhi = d3.max(vals);
        var svg = d3.select("body")
              .append("svg")
              .attr("width", w)
              .attr("height", h);

        svg.selectAll("rect")
           .data(vals)
           .enter()
           .append("rect")
           .attr("x", function(d, i) {
              return i * (w / vals.length);
           })
           .attr("y", function(d) {
              return h * (1 - d / yhi) * scaling;
           })
           .attr("width", w / vals.length - barPadding)
           .attr("height", function(d) {
              return d * h / yhi * scaling;
           })
           .attr("fill", function(d,i) {
            //return "rgb(0, 0, " + (d * 10) + ")";
            //return "steelblue";
               return data[i].color;
           });

        svg.selectAll("text")
           .data(vals)
           .enter()
           .append("text")
           .text(function(d) {
              return d;
           })
           .attr("text-anchor", "middle")
           .attr("x", function(d, i) {
              return i * (w / vals.length) + (w / vals.length - barPadding) / 2;
           })
           .attr("y", function(d) {
              return h * (1 - d / yhi) * scaling + 15;
           })
           .attr("font-family", "sans-serif")
           .attr("font-size", "15px")
           .attr("fill", "white");

        svg.selectAll(".bartext")
           .data(vals)
           .enter()
           .append("text")
           .text(function(d,i) {
              return data[i].code;
           })
           .attr("text-anchor", "middle")
           .attr("x", function(d, i) {
              return i * (w / vals.length) + (w / vals.length - barPadding) / 2;
           })
           .attr("y", function(d) {
              return h;
           })
           .attr("font-family", "sans-serif")
           .attr("font-size", "15px")
           .attr("fill", "rgb(72,72,72)");

      }
		</script>
    <script> 
      var data = [{code:"C++",color:"goldenrod",val:3.3},
                  {code:"Scala",color:"mediumseagreen",val:7.2},
                  {code:"Julia",color:"crimson",val:9.1},
                  {code:"R",color:"darkcyan",val:51.2}];
      barchart(data,.97,800,500,2);
      alert(t);
    </script>
	</body>
</html>
