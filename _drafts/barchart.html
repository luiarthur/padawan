<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>D3 Demo: Making a bar chart with value labels!</title>
		<script type="text/javascript" src="/js/d3.min.js"></script>
		<style type="text/css">
			/* No style rules here yet */		
		</style>
	</head>
	<body>
		<script type="text/javascript">
      function barchart(dataset,scaling,w,h,barPadding) {
        //Width and height
        if (w === undefined) {
          var w = 500;
        }
        if (h === undefined) {
          var h = 100;
        }
        if (barPadding === undefined) {
          var barPadding = 1;
        }
        if (legend === undefined) {
          var scaling = 1;
        } else {
          var scaling = .95;
        }

        //Create SVG element
        yhi = d3.max(dataset);
        var svg = d3.select("body")
              .append("svg")
              .attr("width", w)
              .attr("height", h);

        svg.selectAll("rect")
           .data(dataset)
           .enter()
           .append("rect")
           .attr("x", function(d, i) {
              return i * (w / dataset.length);
           })
           .attr("y", function(d) {
              return h * (1 - d / yhi) * scaling;
           })
           .attr("width", w / dataset.length - barPadding)
           .attr("height", function(d) {
              return d * h / yhi * scaling;
           })
           .attr("fill", function(d) {
            //return "rgb(0, 0, " + (d * 10) + ")";
            return "steelblue";
           });

        svg.selectAll("text")
           .data(dataset)
           .enter()
           .append("text")
           .text(function(d) {
              return d;
           })
           .attr("text-anchor", "middle")
           .attr("x", function(d, i) {
              return i * (w / dataset.length) + (w / dataset.length - barPadding) / 2;
           })
           .attr("y", function(d) {
              return h * (1 - d / yhi) * scaling + 15;
           })
           .attr("font-family", "sans-serif")
           .attr("font-size", "15px")
           .attr("fill", "white");
      }
		</script>
    <script> 
      var dataset = [ 3.3, 7.2, 9.1, 51.2 ];
      var legend = [{code:"C++",color:"yellow",val:3.3},
                    {code:"Scala",color:"green",val:7.2},
                    {code:"Julia",color:"red",val:9.1},
                    {code:"R",color:"blue",val:51.2}];
      barchart(dataset,legend,800,500,2);
      var t = legend.forEach(function(d){return d.val;});
      alert(t);
    </script>
	</body>
</html>
